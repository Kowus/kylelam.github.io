<script src="http://cdn.peerjs.com/0.3/peer.min.js"></script>
<script>
var peerjs = new Peer({key: 'lwjd5qra8257b9'});
var isRemote = window.location.href.indexOf('role=remote')!=-1;

if (isRemote){
	var peerID = window.location.href.match(/[&?]peerID=[^&]*/g)[0].split("=")[1]
	var conn = peer.connect(peerID);
	conn.on('open', function(){
		conn.send('<h1>hi!</h1>');
	});
} else {
	//is detail screen
	var qrcodeAPI = 'https://api.qrserver.com/v1/create-qr-code/?size=500x500&data=';
	var remoteAddress = window.location.href.split('?')[0] + '?role=remote&peerID=';
	peerjs.on('open', function(id) {
		console.log('My peer ID is: ' + id);
		var qrcodeURL = qrcodeAPI + remoteAddress +id;
		document.getElementById("qrcode").src=qrcodeURL;
	});
	
	peerjs.on('connection', function(conn) {
		conn.on('data', function(data){
    			document.getElementById("main").innerHTML=data;
		});
	});
}

</script>

<div id="main" style="height: 100%; width: 100%; background-color: lightblue;">
	
	<img src="" id="qrcode" align="middle"/>
	
</div>
